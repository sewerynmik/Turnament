@model IEnumerable<Match>
@{
    var rounds = Model.GroupBy(m => m.Round).OrderBy(g => g.Key);
}

<div class="tournament-bracket">
    @foreach (var round in rounds)
    {
        <div class="bracket-round">
            <h3>Runda @round.Key</h3>
            @foreach (var match in round)
            {
                <div class="bracket-match @(match.WinnerId.HasValue ? "completed" : "")">
                    <div class="bracket-team @(match.WinnerId == match.Team1Id ? "winner" : "")">
                        @(match.Team1?.Name ?? "TBD")
                    </div>
                    <div class="bracket-team @(match.WinnerId == match.Team2Id ? "winner" : "")">
                        @(match.Team2?.Name ?? "TBD")
                    </div>
                    
                    @if (!match.WinnerId.HasValue && match.Team1Id.HasValue && match.Team2Id.HasValue)
                    {
                        <div class="bracket-actions">
                            <form asp-action="UpdateMatchResult" method="post" class="d-inline">
                                <input type="hidden" name="matchId" value="@match.Id" />
                                <button type="submit" name="winnerId" value="@match.Team1Id" class="btn btn-sm btn-outline-success">
                                    Wygrana @match.Team1.Name
                                </button>
                                <button type="submit" name="winnerId" value="@match.Team2Id" class="btn btn-sm btn-outline-success">
                                    Wygrana @match.Team2.Name
                                </button>
                            </form>
                        </div>
                    }
                </div>
            }
        </div>
    }
</div>

<style>
.tournament-bracket {
    display: flex;
    gap: 2rem;
    padding: 2rem;
    overflow-x: auto;
}

.bracket-round {
    min-width: 250px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.bracket-match {
    border: 1px solid #ddd;
    padding: 1rem;
    border-radius: 4px;
    background: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.bracket-team {
    padding: 0.5rem;
    margin: 0.25rem 0;
    background: #f8f9fa;
    border-radius: 3px;
}

.winner {
    background: #d4edda;
    font-weight: bold;
}

.completed {
    opacity: 0.8;
}

.bracket-actions {
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px solid #eee;
}

.bracket-actions button {
    margin: 0.25rem;
}
</style>